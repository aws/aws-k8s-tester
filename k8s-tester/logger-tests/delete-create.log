‚ûú  logger-tests git:(master) ‚úó go run cmd/k8s-tester-logger-tests/main.go delete \
    --namespace loggertests \
    --kubectl-path="/usr/local/bin/kubectl" \
    --kubeconfig-path="/Users/jonahjo/.kube/config" \
    --log-outputs="/Users/jonahjo/go/src/code.amazon.com/aws-k8s-tester/k8s-tester/logger-tests/log.log"
{"level":"info","ts":"2021-05-05T10:42:22.104-0500","caller":"client/client.go:221","msg":"creating config from KUBECONFIG","kubeconfig":"/Users/jonahjo/.kube/config"}
‚úî Yes, let's "delete"!
{"level":"info","ts":"2021-05-05T10:42:24.448-0500","caller":"client/serviceaccounts.go:15","msg":"deleting ServiceAccount","namespace":"loggertests","name":"fluentbit-service-account"}
{"level":"info","ts":"2021-05-05T10:42:26.970-0500","caller":"client/serviceaccounts.go:27","msg":"deleted ServiceAccount","namespace":"loggertests","name":"fluentbit-service-account"}
{"level":"info","ts":"2021-05-05T10:42:26.972-0500","caller":"logger-tests/tester.go:109","msg":"wait for a minute after deleting ServiceAccount"}
{"level":"info","ts":"2021-05-05T10:42:26.972-0500","caller":"client/rbac.go:15","msg":"deleting RBACClusterRole","name":"fluentbit-rbac-role"}
{"level":"info","ts":"2021-05-05T10:42:27.215-0500","caller":"client/rbac.go:27","msg":"deleted RBACClusterRole","name":"fluentbit-rbac-role"}
{"level":"info","ts":"2021-05-05T10:42:27.215-0500","caller":"logger-tests/tester.go:118","msg":"Deleting %s: %s","ClusterRole":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.215-0500","caller":"client/rbac.go:45","msg":"deleting RBACClusterRoleBinding","name":"fluentbit-rbac-role-binding"}
{"level":"info","ts":"2021-05-05T10:42:27.289-0500","caller":"client/rbac.go:57","msg":"deleted RBACClusterRoleBinding","name":"fluentbit-rbac-role-binding"}
{"level":"info","ts":"2021-05-05T10:42:27.289-0500","caller":"logger-tests/tester.go:127","msg":"Deleting %s: %s","ClusterRoleBinding":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.289-0500","caller":"client/configmaps.go:15","msg":"deleting Configmap","namespace":"loggertests","name":"fluentbit-configmap-config"}
{"level":"info","ts":"2021-05-05T10:42:27.368-0500","caller":"client/configmaps.go:27","msg":"deleted Configmap","namespace":"loggertests","name":"fluentbit-configmap-config"}
{"level":"info","ts":"2021-05-05T10:42:27.368-0500","caller":"logger-tests/tester.go:137","msg":"Deleting %s: %s","Configmap":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.368-0500","caller":"client/daemonsets.go:21","msg":"deleting DaemonSet","namespace":"loggertests","name":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.594-0500","caller":"client/daemonsets.go:33","msg":"deleted DaemonSets","namespace":"loggertests","name":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.594-0500","caller":"logger-tests/tester.go:147","msg":"Deleting %s: %s","DaemonSet":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:42:27.594-0500","caller":"logger-tests/tester.go:148","msg":"wait for a minute after deleting DaemonSet"}
{"level":"info","ts":"2021-05-05T10:43:27.600-0500","caller":"client/services.go:18","msg":"deleting Service","namespace":"loggertests","name":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:43:27.707-0500","caller":"client/services.go:30","msg":"deleted Service","namespace":"loggertests","name":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:43:27.707-0500","caller":"logger-tests/tester.go:159","msg":"Deleting %s: %s","Service":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:43:27.707-0500","caller":"client/pods.go:124","msg":"deleting Pod","namespace":"loggertests","name":"alpine"}
{"level":"info","ts":"2021-05-05T10:43:27.782-0500","caller":"client/pods.go:136","msg":"deleted Pod","namespace":"loggertests","name":"alpine"}
{"level":"info","ts":"2021-05-05T10:43:27.782-0500","caller":"logger-tests/tester.go:169","msg":"Deleting %s: %s","Pod":"alpine"}
{"level":"info","ts":"2021-05-05T10:43:27.782-0500","caller":"client/namespaces.go:74","msg":"deleting namespace","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:43:27.859-0500","caller":"client/namespaces.go:83","msg":"deleted namespace","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:43:27.859-0500","caller":"client/namespaces.go:110","msg":"waiting for namespace deletion","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:43:27.939-0500","caller":"client/namespaces.go:128","msg":"namespace still exists","namespace":"loggertests"}
{"level":"warn","ts":"2021-05-05T10:43:27.939-0500","caller":"client/namespaces.go:136","msg":"deleting namespace finalizers to force-delete","namespace":"loggertests","finalizers":["foregroundDeletion"]}
{"level":"info","ts":"2021-05-05T10:43:28.011-0500","caller":"client/namespaces.go:146","msg":"deleted namespace finalizers","namespace":"loggertests","finalizers":["foregroundDeletion"]}
{"level":"info","ts":"2021-05-05T10:43:43.012-0500","caller":"client/namespaces.go:110","msg":"waiting for namespace deletion","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:43:43.083-0500","caller":"client/namespaces.go:117","msg":"namespace already deleted","namespace":"loggertests"}

*********************************
'k8s-tester-logger-tests delete' success





##### Create


‚ûú  logger-tests git:(master) ‚úó go run cmd/k8s-tester-logger-tests/main.go apply \
    --namespace loggertests \
    --kubectl-path="/usr/local/bin/kubectl" \
    --kubeconfig-path="/Users/jonahjo/.kube/config" \
    --log-outputs="/Users/jonahjo/go/src/code.amazon.com/aws-k8s-tester/k8s-tester/logger-tests/log.log"
{"level":"info","ts":"2021-05-05T10:45:03.630-0500","caller":"client/client.go:221","msg":"creating config from KUBECONFIG","kubeconfig":"/Users/jonahjo/.kube/config"}
‚úî Yes, let's "apply"!
{"level":"info","ts":"2021-05-05T10:46:10.656-0500","caller":"client/namespaces.go:38","msg":"creating namespace","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:46:12.830-0500","caller":"client/namespaces.go:43","msg":"created namespace","namespace":"loggertests"}
{"level":"info","ts":"2021-05-05T10:46:12.830-0500","caller":"logger-tests/fluent-bit.go:38","msg":"creating %s: %s","ServiceAccount":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:12.907-0500","caller":"logger-tests/fluent-bit.go:66","msg":"Create resource","ServiceAccount":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:12.907-0500","caller":"logger-tests/fluent-bit.go:71","msg":"creating %s: %s","ClusterRole":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.127-0500","caller":"logger-tests/fluent-bit.go:122","msg":"Create resource","ClusterRole":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.127-0500","caller":"logger-tests/fluent-bit.go:127","msg":"creating %s: %s","ClusterRoleBinding":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.203-0500","caller":"logger-tests/fluent-bit.go:170","msg":"Create resource","ClusterRoleBinding":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.203-0500","caller":"logger-tests/fluent-bit.go:243","msg":"creating %s: %s","Configmap":"fluentbit-configmap-config"}
{"level":"info","ts":"2021-05-05T10:46:13.275-0500","caller":"logger-tests/fluent-bit.go:280","msg":"Create resource","Configmap":"fluentbit-configmap-config"}
{"level":"info","ts":"2021-05-05T10:46:13.275-0500","caller":"logger-tests/fluent-bit.go:285","msg":"creating %s: %s","Daemonset":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.501-0500","caller":"logger-tests/fluent-bit.go:396","msg":"Create resource","Daemonset":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:13.510-0500","caller":"client/daemonsets.go:68","msg":"waiting DaemonSets completes","namespace":"loggertests","job-name":"fluent-bit","initial-wait":"10s","poll-interval":"10s","ctx-duration-left":"59.991328s","ctx-time-left":"59.991327s"}


üèä üö£ ‚õµ üåé  ‚öì Waiting for Deployment completes fluent-bit

"/usr/local/bin/kubectl --kubeconfig=/Users/jonahjo/.kube/config --namespace=loggertests describe daemonset fluent-bit" output:
Name:           fluent-bit
Selector:       app.kubernetes.io/name=fluent-bit
Node-Selector:  <none>
Labels:         <none>
Annotations:    deprecated.daemonset.template.generation: 1
Desired Number of Nodes Scheduled: 2
Current Number of Nodes Scheduled: 2
Number of Nodes Scheduled with Up-to-date Pods: 2
Number of Nodes Scheduled with Available Pods: 2
Number of Nodes Misscheduled: 0
Pods Status:  2 Running / 0 Waiting / 0 Succeeded / 0 Failed
Pod Template:
  Labels:           app.kubernetes.io/name=fluent-bit
  Service Account:  fluentbit-service-account
  Containers:
   fluent-bit:
    Image:      fluent/fluent-bit:1.5
    Port:       <none>
    Host Port:  <none>
    Limits:
      memory:  500Mi
    Requests:
      cpu:        500m
      memory:     100Mi
    Environment:  <none>
    Mounts:
      /fluent-bit/etc/ from fluentbit-configmap-config (rw)
      /var/lib/docker/containers from varlibdockercontainers (ro)
      /var/log from varlog (rw)
  Volumes:
   fluentbit-configmap-config:
    Type:      ConfigMap (a volume populated by a ConfigMap)
    Name:      fluentbit-configmap-config
    Optional:  false
   varlog:
    Type:          HostPath (bare host directory volume)
    Path:          /var/log
    HostPathType:  DirectoryOrCreate
   varlibdockercontainers:
    Type:          HostPath (bare host directory volume)
    Path:          /var/lib/docker/containers
    HostPathType:  DirectoryOrCreate
Events:
  Type    Reason            Age   From                  Message
  ----    ------            ----  ----                  -------
  Normal  SuccessfulCreate  13s   daemonset-controller  Created pod: fluent-bit-w6bw7
  Normal  SuccessfulCreate  13s   daemonset-controller  Created pod: fluent-bit-tt44x


{"level":"info","ts":"2021-05-05T10:46:26.964-0500","caller":"client/daemonsets.go:111","msg":"fetched DaemonSet","current-number-scheduled":2,"number-misscheduled":0,"desired-number-scheduled":2,"number-ready":2,"condition-type":"","condition-status":"","condition-reason":"","condition-message":""}
{"level":"warn","ts":"2021-05-05T10:46:26.964-0500","caller":"client/daemonsets.go:122","msg":"pods available; returning","available":2,"target":2}
{"level":"info","ts":"2021-05-05T10:46:26.964-0500","caller":"logger-tests/fluent-bit.go:438","msg":"creating %s: %s","Service":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:27.050-0500","caller":"logger-tests/fluent-bit.go:477","msg":"Create resource","Service":"fluent-bit"}
{"level":"info","ts":"2021-05-05T10:46:27.050-0500","caller":"logger-tests/fluent-bit.go:482","msg":"Testing HTTP Client for %s: %s","Daemonset":"fluent-bit"}
STEP: Creating Pod alpine to test HTTP Client
{"level":"info","ts":"2021-05-05T10:46:37.137-0500","caller":"client/pods.go:90","msg":"waiting pod logs","namespace":"loggertests","pod-name":"alpine"}
{"level":"info","ts":"2021-05-05T10:46:37.223-0500","caller":"logger-tests/fluent-bit.go:516","msg":"HTTP CLIENT:","TEST":"PASSED"}

*********************************
'k8s-tester-logger-tests apply' success
